<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>

<div id="map_content" style="width:500px; height: 500px; background: #52514e">&nbsp;</div>

<script type="text/javascript">
(function() {
  window.onload = function(){
    var latlng = new google.maps.LatLng(<%="#{@center.lat},#{@center.lng}"%>);
    var options = {
      zoom: <%=@zoom%>,
      center: latlng,
      scaleControl: true,
      navigationControlOptions: {style: google.maps.NavigationControlStyle.SMALL },
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    var map = new google.maps.Map(document.getElementById('map_content'), options);

  <% @data_points.each do |idx,point| %>
    var marker = new google.maps.Marker({  
      position: new google.maps.LatLng(<%=point[:lat]%>, <%=point[:lng]%>),  
      icon: 'http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=<%=point[:count]%>|FE6256|000000',
      map: map  
    });
  <% end -%>

  }
})();

</script>

